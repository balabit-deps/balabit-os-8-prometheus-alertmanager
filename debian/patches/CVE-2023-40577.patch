From 236ce26e55283b8497498a2d66cfdeaa47bcb43e Mon Sep 17 00:00:00 2001
From: Simon Pasquier <spasquie@redhat.com>
Date: Wed, 23 Aug 2023 13:36:30 +0200
Subject: [PATCH] Check the validity of the generatorURL field

The Source button should only be displayed if the link starts by
'http://' or 'https://'.

Signed-off-by: Simon Pasquier <spasquie@redhat.com>
---

Index: prometheus-alertmanager-0.15.3+ds/ui/app/src/Views/AlertList/AlertView.elm
===================================================================
--- prometheus-alertmanager-0.15.3+ds.orig/ui/app/src/Views/AlertList/AlertView.elm
+++ prometheus-alertmanager-0.15.3+ds/ui/app/src/Views/AlertList/AlertView.elm
@@ -151,8 +151,12 @@ silenceButton alert =
 
 generatorUrlButton : String -> Html Msg
 generatorUrlButton url =
-    a
-        [ class "btn btn-outline-info border-0", href url ]
-        [ i [ class "fa fa-line-chart mr-2" ] []
-        , text "Source"
-        ]
+    if String.startsWith "http://" url || String.startsWith "https://" url then
+        a
+            [ class "btn btn-outline-info border-0", href url ]
+            [ i [ class "fa fa-line-chart mr-2" ] []
+            , text "Source"
+            ]
+
+    else
+        text ""
